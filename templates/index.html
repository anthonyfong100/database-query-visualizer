{% extends "base.html" %} {% block title %} Query Plan {% endblock %} {% block
content %}

<nav class="navbar navbar-expand-lg navbar-light bg-light">
  <a class="navbar-brand" href="#">Query Plan</a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
    aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
</nav>
<div class="px-5">
  <div class="row mt-3">
    <div class="col-4">
      <form method="POST" action="/result">
        <div class="form-group">
          <label for="queryTextArea">Insert Query</label>
          <textarea class="form-control" id="queryTextArea" name="queryText" rows="10"
            placeholder="Type your SQL query here"></textarea>
        </div>
        <button id="btnFetch" type="submit" class="btn btn-primary">
          Submit
        </button>
        <p class="mt-3">
          We introduced a custom syntax to vary the selectivity of a query for
          this project. Use a custom <code>VARY()</code> function within a
          <code>WHERE</code> clause to let our querying engine generate
          alternative plans with varying selectivity. Note that
          <code>VARY()</code> only works on numerical columns.
        </p>
        <span>Example:</span>
        <code>
          SELECT * FROM lineitem WHERE VARY(l_quantity) 
        </code>
        <p class="mt-3">
          The engine will vary the selectivity based on its statistical distribution and
          conduct queries with different values.
        </p>
      </form>
    </div>
    <div class="col-8">
      <h3>Query</h3>
      {% if query %}
      <code>{{query}}</code>
      {% else %}
      <span>Insert query to begin</span>
      {% endif %}
      <hr />
      <h3 class="mt-3">Query Plan 1</h3>
      {% if explanation %}
      <ol>
        {% for item in explanation %}
        <li>{{item}}</li>
        {% endfor %}
      </ol>
      {% else %}
      <span>Insert query to begin</span>
      {% endif %}
      {% if graph_1 %}
      <img src="{{ url_for('static', filename=graph_1) }}" width="600" height="400" />
      {% endif %}
      <hr />
      <h3 class="mt-3">Query Plan 2</h3>
      {% if explanation %}
      <ol>
        {% for item in explanation %}
        <li>{{item}}</li>
        {% endfor %}
      </ol>
      {% else %}
      <span>Insert query to begin</span>
      {% endif %}
      {% if graph_2 %}
      <img src="{{ url_for('static', filename=graph_2) }}" width="600" height="400" />
      {% endif %}
      <hr />
      <h3 class="mt-3">Query Plan 3</h3>
      {% if explanation %}
      <ol>
        {% for item in explanation %}
        <li>{{item}}</li>
        {% endfor %}
      </ol>
      {% else %}
      <span>Insert query to begin</span>
      {% endif %}
      {% if graph_3 %}
      <img src="{{ url_for('static', filename=graph_3) }}" width="600" height="400" />
      {% endif %}
      <hr />
      <h3 class="mt-3">Histogram Bounds</h3>
      {% if bounds %}
      <ol>
        {% for item in bounds %}
        <li>{{item}}</li>
        {% endfor %}
      </ol>
      {% else %}
      <span>Insert query to begin</span>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}